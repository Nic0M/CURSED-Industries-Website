/*

 Copyright The Closure Library Authors.
 Copyright The Closure Compiler Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var COMPILED=!0,goog=goog||{};goog.exportPath_=function(a,c,d,b){a=a.split(".");b=b||globalThis;a[0]in b||"undefined"==typeof b.execScript||b.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)if(a.length||void 0===c)b=b[e]&&b[e]!==Object.prototype[e]?b[e]:b[e]={};else if(!d&&goog.isObject_(c)&&goog.isObject_(b[e]))for(var f in c)c.hasOwnProperty(f)&&(b[e][f]=c[f]);else b[e]=c};
goog.define=function(a,c){if(!COMPILED){var d=globalThis.CLOSURE_DEFINES;d&&void 0===d.nodeType&&Object.prototype.hasOwnProperty.call(d,a)&&(c=d[a])}return c};goog.FEATURESET_YEAR=2012;goog.DEBUG=!0;goog.LOCALE="en";goog.provide=function(a){if(goog.isInModuleLoader_())throw Error("goog.provide cannot be used within a module.");if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)};
goog.constructNamespace_=function(a,c,d){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName_(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a,c,d)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(a){if("string"!==typeof a||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly. Note, modules cannot be loaded as normal scripts. They require some kind of pre-processing step. You're likely trying to load a module via a script tag or as a part of a concatenated bundle without rewriting the module. For more info see: https://github.com/google/closure-library/wiki/goog.module:-an-ES6-module-like-alternative-to-goog.provide.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");
goog.moduleLoaderState_.moduleName=a;if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}};goog.module.get=function(a){return goog.module.getInternal_(a)};goog.module.getInternal_=function(a){if(!COMPILED){if(a in goog.loadedModules_)return goog.loadedModules_[a];if(!goog.implicitNamespaces_[a])return a=goog.getObjectByName_(a),null!=a?a:null}return null};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return!!goog.moduleLoaderState_};
goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};goog.forwardDeclare=function(a){};
COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&null!=goog.getObjectByName_(a)},goog.implicitNamespaces_={"goog.module":!0});goog.getObjectByName_=function(a,c){a=a.split(".");c=c||globalThis;for(var d=0;d<a.length;d++)if(c=c[a[d]],null==c)return null;return c};goog.require=function(a){if(!COMPILED)return goog.isProvided_(a)?goog.module.getInternal_(a):null};goog.requireType=function(a){return{}};goog.SEAL_MODULE_EXPORTS=goog.DEBUG;
goog.loadedModules_={};
goog.loadModule=function(a){var c=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:"",declareLegacyNamespace:!1};var d={},b=d;if("function"===typeof a)b=a.call(void 0,b);else throw Error("Invalid module definition");var e=goog.moduleLoaderState_.moduleName;if("string"===typeof e&&e)goog.moduleLoaderState_.declareLegacyNamespace?goog.constructNamespace_(e,b,d!==b):goog.SEAL_MODULE_EXPORTS&&Object.seal&&"object"==typeof b&&null!=b&&Object.seal(b),goog.loadedModules_[e]=b;else throw Error('Invalid module name "'+
e+'"');}finally{goog.moduleLoaderState_=c}};goog.isObject_=function(a){var c=typeof a;return"object"==c&&null!=a||"function"==c};
goog.getCssName=function(a,c){if("."==String(a).charAt(0))throw Error('className passed in goog.getCssName must not start with ".". You passed: '+a);var d=function(e){return goog.cssNameMapping_[e]||e},b=function(e){e=e.split("-");for(var f=[],h=0;h<e.length;h++)f.push(d(e[h]));return f.join("-")};b=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?d:b:function(e){return e};a=c?a+"-"+b(c):b(a);return globalThis.CLOSURE_CSS_NAME_MAP_FN?globalThis.CLOSURE_CSS_NAME_MAP_FN(a):a};
goog.setCssNameMapping=function(a,c){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=c};!COMPILED&&globalThis.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=globalThis.CLOSURE_CSS_NAME_MAPPING);goog.GetMsgOptions=function(){};
goog.getMsg=function(a,c,d){d&&d.html&&(a=a.replace(/</g,"&lt;"));d&&d.unescapeHtmlEntities&&(a=a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&"));c&&(a=a.replace(/\{\$([^}]+)}/g,function(b,e){return null!=c&&e in c?c[e]:b}));return a};goog.getMsgWithFallback=function(a,c){return a};goog.exportSymbol=function(a,c,d){goog.exportPath_(a,c,!0,d)};goog.exportProperty=function(a,c,d){a[c]=d};goog.reflect={};goog.reflect.object=function(a,c){return c};
goog.reflect.objectProperty=function(a,c){return a};goog.reflect.sinkValue=function(a){goog.reflect.sinkValue[" "](a);return a};goog.reflect.sinkValue[" "]=function(){};var module$exports$custom_table_search={};function module$contents$custom_table_search_calc_lcs(a,c){const d=a.length,b=c.length;let e=Array(d+1);for(var f=0;f<d+1;f++)e[f]=Array(b+1);for(f=0;f<d+1;f++)for(let h=0;h<b+1;h++)e[f][h]=0===f||0===h?0:a[f-1]===c[h-1]?1+e[f-1][h-1]:Math.max(e[f-1][h],e[f][h-1]);return e[d][b]}
function module$contents$custom_table_search_search_table(a,c,d,b=!1){var e=document.getElementById(a);if(e)if(a=document.getElementById(c))if(c=e.value,""===c)for(d=a.getElementsByTagName("tr"),b=1;b<d.length;b++)d[b].style.display="";else if(b||(c=c.toLowerCase()),e=a.getElementsByTagName("tr"),1>e.length)console.error("Table has no header row");else{a=e[0];for(let f=1;f<e.length;f++){const h=e[f].getElementsByTagName("td");let l=!1;for(let g=0;g<d.length;g++){if(g>=a.cells.length){console.error(`Column index ${d[g]} out of range`);
continue}let k=h[d[g]].innerText;switch(a.cells[d[g]].innerText){case "Unique ID":b||(k=k.toLowerCase());lcs=module$contents$custom_table_search_calc_lcs(c,k);3>Math.abs(lcs-c.length)?(l=!0,console.log(`Match found: ${c} and ${k}`)):console.log(`No match: ${c} and ${k}`);break;default:b||(k=k.toLowerCase()),k.includes(c)&&(console.log(`Default match found: ${c} and ${k}`),l=!0)}if(l){e[f].style.display="";break}}l||(e[f].style.display="none")}}else console.error(`No table with id ${c}`);else console.error(`No search bar with id ${a}`)}
module$exports$custom_table_search.search_table=module$contents$custom_table_search_search_table;var module$exports$database_tables={};function module$contents$database_tables_format_speed(a){return a+" m/s"}function module$contents$database_tables_format_altitude(a){return null===a?"Unknown":a+" m"}function module$contents$database_tables_format_heading(a){return 90>a?a+"\u00b0 NE":180>a?a+"\u00b0 SE":270>a?a+"\u00b0 SW":360>a?a+"\u00b0 NW":a+"\u00b0"}function module$contents$database_tables_format_latitude(a){a=parseFloat(a);return 0>a?(-a).toFixed(6)+"\u00b0 S":a.toFixed(6)+"\u00b0 N"}
function module$contents$database_tables_format_longitude(a){a=parseFloat(a);return 0>a?(-a).toFixed(6)+"\u00b0 W":a.toFixed(6)+"\u00b0 E"}function module$contents$database_tables_format_timestamp(a){"string"!==typeof a||a.endsWith("Z")||(a+="Z");return(new Date(a)).toLocaleString("en-US",{timeZone:"America/Denver",timeZoneName:"short"})}
function module$contents$database_tables_format_duration(a){return 60>a?a+(1===a?" second":" seconds"):3600>a?Math.floor(a/60)+(1===Math.floor(a/60)?" minute ":" minutes ")+module$contents$database_tables_format_duration(a%60):86400>a?Math.floor(a/3600)+(1===Math.floor(a/3600)?" hour ":" hours ")+module$contents$database_tables_format_duration(a%3600):Math.floor(a/86400)+(1===Math.floor(a/86400)?" day ":" days ")+module$contents$database_tables_format_duration(a%86400)}
function module$contents$database_tables_updateDateStr(a,c){c=document.getElementsByClassName(c);if(0===c.length)console.log("No last refreshed elements found. Cannot update last refreshed time.");else{a*=1E3;var d=(Date.now()-a)/1E3,b="Last refreshed: ";60>d?(b+=Math.floor(d).toString(),b=1!==d?b+" seconds ago":b+" second ago"):3600>d?(d=Math.floor(d/60),b+=d.toString(),b=1!==d?b+" minutes ago":b+" minute ago"):86400>d?(d=Math.floor(d/3600),b+=d.toString(),b=1!==d?b+" hours ago":b+" hour ago"):(d=
Math.floor(d/86400),b+=d.toString(),b=1!==d?b+" days ago":b+" day ago");a=(new Date(a)).toLocaleString("en-US",{timeZone:"America/Denver",timeZoneName:"short"});b+=" at "+a;for(a=0;a<c.length;a++)c[a].innerText=b}}
function module$contents$database_tables_createSearchBar(a,c){const d=document.getElementById(a);if(d){d.innerHTML="";a=document.createElement("input");var b=c+"-search-bar";a.setAttribute("id",b);a.setAttribute("placeholder","Search by unique ID, flight date, or location...");a.setAttribute("style","width: 50%;");a.setAttribute("class","form-control");a.addEventListener("input",function(){module$contents$custom_table_search_search_table(b,c,[0],!1)});return a}console.log("Search bar div does not exist:",
a);console.log("Cannot create search bar.")}function module$contents$database_tables_searchTable(a,c){a=document.getElementById(a).value.toLowerCase();c=document.getElementById(c).getElementsByTagName("tr");for(let d=1;d<c.length;d++){const b=c[d].getElementsByTagName("td");let e=!1;for(let f=0;f<b.length;f++)if(b[f].innerText.toLowerCase().includes(a)){e=!0;break}c[d].style.display=e?"":"none"}}
async function module$contents$database_tables_getActiveFlights(){try{const h=await fetch("https://cursedindustries.com/wp-json/drones/v1/active-flights"),l=await h.json();console.log(l);const g=document.getElementById("active-flights-table");g.innerHTML="";g.setAttribute("style","overflow-x: scroll;");if(200!==h.status)g.innerHTML="Error: Could not fetch list of active flights. Please try again later.";else{var a=document.createElement("div");a.setAttribute("id","active-flights-search-bar-div");
g.appendChild(a);var c=module$contents$database_tables_createSearchBar("active-flights-search-bar-div","active-flights-table");a.appendChild(c);var d=document.createElement("p");d.setAttribute("class","active-flights-last-refreshed-text");g.appendChild(d);module$contents$database_tables_updateDateStr(l.current_time,"active-flights-last-refreshed-text");var b=document.createElement("table"),e=b.createTHead();b.setAttribute("class","table table-striped");var f=e.insertRow();f.setAttribute("style","background-color: #00aa00; color: black;");
f.insertCell().innerHTML="Unique ID";f.insertCell().innerHTML="Latitude";f.insertCell().innerHTML="Longitude";f.insertCell().innerHTML="Altitude";f.insertCell().innerHTML="Ground Speed";f.insertCell().innerHTML="Vertical Speed";f.insertCell().innerHTML="Heading";f.insertCell().innerHTML="Last Updated";l.flights.forEach(k=>{const m=b.insertRow();m.insertCell().innerHTML=k.unique_id;m.insertCell().innerHTML=module$contents$database_tables_format_latitude(k.lat);m.insertCell().innerHTML=module$contents$database_tables_format_longitude(k.lon);
m.insertCell().innerHTML=module$contents$database_tables_format_altitude(k.alt);m.insertCell().innerHTML=module$contents$database_tables_format_speed(k.gnd_speed);m.insertCell().innerHTML=module$contents$database_tables_format_speed(k.vert_speed);m.insertCell().innerHTML=module$contents$database_tables_format_heading(k.heading);m.insertCell().innerHTML=module$contents$database_tables_format_timestamp(k.timestamp)});g.appendChild(b);0!==module$contents$database_tables_active_flights_refresh_time_text_interval_id&&
clearInterval(module$contents$database_tables_active_flights_refresh_time_text_interval_id);module$contents$database_tables_active_flights_refresh_time_text_interval_id=setInterval(()=>module$contents$database_tables_updateDateStr(l.current_time,"active-flights-last-refreshed-text"),module$contents$database_tables_refresh_text_interval_time)}}catch(h){console.log("Error:",h)}}
async function module$contents$database_tables_getHistoricalFlights(){try{url="https://cursedindustries.com/wp-json/drones/v1/historical-flights";const g=await fetch(url,{method:"GET",headers:{"Content-Type":"application/json"}}),k=await g.json();if(200!==g.status)console.log("Error:",k);else{var a=document.getElementById("historical-flights-table");a.innerHTML="";a.setAttribute("style","overflow-x: scroll;");var c=document.createElement("div");c.setAttribute("id","historical-flights-search-bar-div");
a.appendChild(c);var d=module$contents$database_tables_createSearchBar("historical-flights-search-bar-div","historical-flights-table");c.appendChild(d);var b=document.createElement("p");b.setAttribute("class","historical-flights-last-refreshed-text");a.appendChild(b,"historical-flights-last-refreshed-text");var e=NaN;void 0!==k.current_time?e=k.current_time:(console.log("Current time could not be parsed from the response. Displaying NaN as last refreshed time."),e=NaN);module$contents$database_tables_updateDateStr(e,
"historical-flights-last-refreshed-text");0!==module$contents$database_tables_historical_flights_refresh_time_text_interval_id&&clearInterval(module$contents$database_tables_historical_flights_refresh_time_text_interval_id);module$contents$database_tables_historical_flights_refresh_time_text_interval_id=setInterval(()=>module$contents$database_tables_updateDateStr(e,"historical-flights-last-refreshed-text"),module$contents$database_tables_refresh_text_interval_time);var f=document.createElement("table");
f.setAttribute("class","table table-striped");var h=f.createTHead().insertRow();h.insertCell().innerHTML="Unique ID";h.insertCell().innerHTML="Duration";h.insertCell().innerHTML="Start Time";h.insertCell().innerHTML="End Time";h.insertCell().innerHTML="Max Height AGL";h.insertCell().innerHTML="Max Speed";var l=f.createTBody();k.flights.forEach(m=>{const n=l.insertRow();let p=n.insertCell();html_str="<a href='/flight-information?src_addr="+m.src_addr+",start_time="+m.start_time+"'>"+m.unique_id+"</a>";
p.innerHTML=html_str;n.insertCell().innerHTML=module$contents$database_tables_format_duration(m.duration);n.insertCell().innerHTML=m.start_time;n.insertCell().innerHTML=m.end_time;n.insertCell().innerHTML=module$contents$database_tables_format_altitude(m.max_height_agl);n.insertCell().innerHTML=module$contents$database_tables_format_speed(m.max_gnd_speed)});a.appendChild(f)}}catch(g){console.log("Error:",g)}}let module$contents$database_tables_current_offset=0;
const module$contents$database_tables_limit=25;
async function module$contents$database_tables_getRemoteIDPackets(a){try{const k=await fetch(`https://cursedindustries.com/wp-json/drones/v1/remoteid-packets?offset=${module$contents$database_tables_current_offset}&limit=${module$contents$database_tables_limit}`),m=await k.json();if(200!==k.status)console.log("Error: Could not fetch list of Remote ID packets. Please try again later."),console.log("Response:",m);else{var c=document.getElementById("remoteid-packets-table");c.innerHTML="";c.setAttribute("style",
"");var d=document.createElement("div");d.setAttribute("id","remoteid-packets-search-bar-div");c.appendChild(d);var b=module$contents$database_tables_createSearchBar("remoteid-packets-search-bar-div","remoteid-packets-table");d.appendChild(b);var e=document.createElement("p");e.setAttribute("class","remoteid-packets-last-refreshed-text");c.appendChild(e);var f=NaN;void 0!==m.current_time?f=m.current_time:(console.log("Current time could not be parsed from the response. Displaying NaN as last refreshed time."),
f=NaN);module$contents$database_tables_updateDateStr(f,"remoteid-packets-last-refreshed-text");0!==module$contents$database_tables_remoteid_packets_refresh_time_text_interval_id&&clearInterval(module$contents$database_tables_remoteid_packets_refresh_time_text_interval_id);module$contents$database_tables_remoteid_packets_refresh_time_text_interval_id=setInterval(()=>module$contents$database_tables_updateDateStr(f,"remoteid-packets-last-refreshed-text"),module$contents$database_tables_refresh_text_interval_time);
var h=document.createElement("div");h.setAttribute("style","overflow-x: scroll; overflow-y: scroll; height: 75vh; position: relative;");c.appendChild(h);var l=document.createElement("table"),g=l.createTHead().insertRow();g.setAttribute("style","background-color: #00aa00; color: black; position: sticky; top: 0;");g.insertCell().innerHTML="Unique ID";g.insertCell().innerHTML="Timestamp";g.insertCell().innerHTML="Heading";g.insertCell().innerHTML="Ground Speed";g.insertCell().innerHTML="Vertical Speed";
g.insertCell().innerHTML="Latitude";g.insertCell().innerHTML="Longitude";g.insertCell().innerHTML="Altitude";m.packets.forEach(n=>{const p=l.insertRow();p.insertCell().innerHTML=n.unique_id;p.insertCell().innerHTML=module$contents$database_tables_format_timestamp(n.timestamp);p.insertCell().innerHTML=module$contents$database_tables_format_heading(n.heading);p.insertCell().innerHTML=module$contents$database_tables_format_speed(n.gnd_speed);p.insertCell().innerHTML=module$contents$database_tables_format_speed(n.vert_speed);
p.insertCell().innerHTML=module$contents$database_tables_format_latitude(n.lat);p.insertCell().innerHTML=module$contents$database_tables_format_longitude(n.lon);p.insertCell().innerHTML=module$contents$database_tables_format_altitude(n.geoAlt)});h.appendChild(l)}}catch(k){console.log("Error:",k)}}
async function module$contents$database_tables_getRaspberryPiStatus(){try{const l=await fetch("https://cursedindustries.com/wp-json/healthcheck/v1/get_healthchecks"),g=await l.json();if(200!==l.status)console.log("Error:",g);else{var a=document.getElementById("healthchecks-table");a.innerHTML="";if(void 0===g.healthchecks)console.log("No healthchecks found in response.");else{var c=g.healthchecks,d=document.createElement("table");d.setAttribute("class","healthchecks-table");d.setAttribute("style",
"overflow-x: scroll;");var b=d.createTHead().insertRow();b.insertCell().innerHTML="Receiver ID";b.insertCell().innerHTML="Status";b.insertCell().innerHTML="Last Updated";b.insertCell().innerHTML="Received Packets";var e=d.createTBody();c.forEach(k=>{const m=e.insertRow();m.insertCell().innerHTML=k.id;m.insertCell().innerHTML=k.status;m.insertCell().innerHTML=k.updated_at;m.insertCell().innerHTML=k.received_packets});var f=document.createElement("p");f.setAttribute("class","healthchecks-last-refreshed-text");
a.appendChild(f);var h=NaN;void 0!==g.current_time?h=g.current_time:(console.log("Current time could not be parsed from the response. Displaying NaN as last refreshed time."),h=NaN);module$contents$database_tables_updateDateStr(h,"healthchecks-last-refreshed-text");0!==module$contents$database_tables_healthchecks_refresh_time_text_interval_id&&clearInterval(module$contents$database_tables_healthchecks_refresh_time_text_interval_id);module$contents$database_tables_healthchecks_refresh_time_text_interval_id=
setInterval(()=>module$contents$database_tables_updateDateStr(h,"healthchecks-last-refreshed-text"),module$contents$database_tables_refresh_text_interval_time);a.appendChild(f);a.appendChild(d)}}}catch(l){console.log("Error:",l)}}
let module$contents$database_tables_active_flights_refresh_time_text_interval_id=0,module$contents$database_tables_historical_flights_refresh_time_text_interval_id=0,module$contents$database_tables_remoteid_packets_refresh_time_text_interval_id=0,module$contents$database_tables_healthchecks_refresh_time_text_interval_id=0,module$contents$database_tables_refresh_text_interval_time=450;console.log("Creating active flights table");module$contents$database_tables_getActiveFlights();console.log("Creating historical flights table");
module$contents$database_tables_getHistoricalFlights();console.log("Create Remote ID packets table");module$contents$database_tables_getRemoteIDPackets();console.log("Create Raspberry Pi status table");module$contents$database_tables_getRaspberryPiStatus();setInterval(module$contents$database_tables_getActiveFlights,3E4);setInterval(module$contents$database_tables_getHistoricalFlights,3E5);setInterval(module$contents$database_tables_getRemoteIDPackets,3E5);
setInterval(module$contents$database_tables_getRaspberryPiStatus,3E5);var module$exports$leaflet_plugins$rotated_marker={};
(function(){var a=L.Marker.prototype._initIcon,c=L.Marker.prototype._setPos,d="msTransform"===L.DomUtil.TRANSFORM;L.Marker.addInitHook(function(){var b=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;b&&=b[0]+"px "+b[1]+"px";this.options.rotationOrigin=this.options.rotationOrigin||b||"center bottom";this.options.rotationAngle=this.options.rotationAngle||0;this.on("drag",function(e){e.target._applyRotation()})});L.Marker.include({_initIcon:function(){a.call(this)},
_setPos:function(b){c.call(this,b);this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[L.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,this._icon.style[L.DomUtil.TRANSFORM]=d?"rotate("+this.options.rotationAngle+"deg)":this._icon.style[L.DomUtil.TRANSFORM]+(" rotateZ("+this.options.rotationAngle+"deg)"))},setRotationAngle:function(b){this.options.rotationAngle=b;this.update();return this},setRotationOrigin:function(b){this.options.rotationOrigin=
b;this.update();return this}})})();var module$exports$drone_maps={};function module$contents$drone_maps_create_trajectory(a,c,d,b,e){trajectory=L.polyline(c,{color:d,opacity:.8});trajectory.addTo(a);a=e.unique_id??"Unknown";d=e.speed??"Unknown";let f=e.heading??"Unknown";e=e.flight_num??0;b.iconAnchor=c[c.length-1];361==f&&(f="Unknown");b.setRotationAngle(f);b.setPopupContent(`UAS ID: <a href="/flight-information?flight=${e}>${a}</a> <br> Speed: ${d} m/s <br> Heading: ${f}\u00b0`)}module$exports$drone_maps.create_trajectory=module$contents$drone_maps_create_trajectory;var module$exports$live_map={};let module$contents$live_map_live_map=L.map("live-map",{center:[40.03,-105.1],zoom:14}),module$contents$live_map_live_map_tile_layer=L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:1,maxZoom:19,zoomSnap:.25,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});module$contents$live_map_live_map_tile_layer.addTo(module$contents$live_map_live_map);red_color="#ff3131";orange_color="#ff914d";
yellow_color="#ffbd59";green_color="#00bf63";cyan_color="#0cc0df";lilac_color="#5271ff";pink_color="#ff66c4";
var module$contents$live_map_DroneIconClass=L.Icon.extend({options:{iconSize:[100,100],iconAnchor:[50,50],popupAnchor:[0,-25],rotationOrigin:"center center"}}),module$contents$live_map_red_icon=new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_red.png"}),module$contents$live_map_orange_icon=new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_orange.png"}),module$contents$live_map_yellow_icon=
new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_yellow.png"}),module$contents$live_map_green_icon=new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_green.png"}),module$contents$live_map_cyan_icon=new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_cyan.png"}),module$contents$live_map_lilac_icon=new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_lilac.png"}),
module$contents$live_map_pink_icon=new module$contents$live_map_DroneIconClass({iconUrl:"https://cursedindustries.com/images/drone_marker_icon_pink.png"});red_marker=L.marker([40.03,-105.1],{icon:module$contents$live_map_red_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm a red drone moving at 50 m/s!");orange_marker=L.marker([40.04,-105.1],{icon:module$contents$live_map_orange_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm an orange drone!");
yellow_marker=L.marker([40.05,-105.1],{icon:module$contents$live_map_yellow_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm a yellow drone!");green_marker=L.marker([40.06,-105.1],{icon:module$contents$live_map_green_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm a green drone!");cyan_marker=L.marker([40.07,-105.1],{icon:module$contents$live_map_cyan_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm a blue drone!");lilac_marker=L.marker([40.08,-105.1],{icon:module$contents$live_map_lilac_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm a purple drone!");
purple_marker=L.marker([40.09,-105.1],{icon:module$contents$live_map_pink_icon}).addTo(module$contents$live_map_live_map).bindPopup("I'm a pink drone!");red_marker.setRotationAngle(45);orange_marker.setRotationAngle(90);yellow_marker.setRotationAngle(135);green_marker.setRotationAngle(180);cyan_marker.setRotationAngle(225);lilac_marker.setRotationAngle(270);purple_marker.setRotationAngle(315);
var module$contents$live_map_red_drone_path_lat_lon=[[43.022,-103.2],[42.023,-104.3],[41.0278,-102.4],[41.031,-104.5],[40.035,-104.87],[40.03,-105.1]],module$contents$live_map_red_polyline=L.polyline(module$contents$live_map_red_drone_path_lat_lon,{color:"#ff3131",opacity:.8}).addTo(module$contents$live_map_live_map);
async function module$contents$live_map_rest_api_trajectory(){let a=1;try{const d=new Headers;d.append("Source-Address","MAC-60:60:1F:DF:3F:C1");d.append("Limit",100);var c=Date.now();let b=(new Date(c)).toISOString();b=b.replace("T"," ").replace("Z","").substring(0,23);d.append("Latest-Timestamp",b);c=200;let e=[],f=null,h=null,l=null;for(;200==c;){f=new Request("https://cursedindustries.com/wp-json/drones/v1/data",{method:"GET",headers:d});try{h=await fetch(f)}catch(g){console.error("Fetch error: ",
g)}try{l=await h.json()}catch(g){console.error("JSON error: ",g);break}c=h.status;switch(c){case 200:last_data=l.data[l.data.length-1];b=last_data.timestamp;d.set("Latest-Timestamp",b);current_heading=last_data.heading??"Unknown";current_speed=last_data.gnd_speed??"Unknown";unique_id=last_data.unique_id??"Unknown";a=last_data.flight_num??0;for(let g=0;g<l.data.length;g++)e.push([l.data[g].lat,l.data[g].lon]);break;case 400:console.log("Bad Request:",f);break;case 404:console.log("End of data");break;
case 500:console.log("Internal server error")}404!==c&&l.error&&console.error(l.error)}drone_stats={unique_id,speed:current_speed,heading:current_heading,flight_num:a};console.log("Lat Lon List:",e);console.log("Drone stats:",drone_stats);module$contents$drone_maps_create_trajectory(module$contents$live_map_live_map,e,orange_color,orange_marker,drone_stats)}catch(d){console.error(d)}}module$contents$live_map_rest_api_trajectory();
